# Creating the Machine Learning Model

## Backgound Challenges

In this lab you will play the role of two different personas: (1) as `adw admin,`
that has the data for the machine learning and (2) the `adw ml_user` that creates a
machine learning model given the data from persona (1).


## **Step 1:** Sign in to Oracle Cloud

- Log in, if you have not already done so.

![](./images/2/002.png  " ")

![](./images/2/003.png  " ")

![](./images/2/0041.png  " ")

![](./images/2/004.png  " ")


## **Step 2:** Navigate to SQL Developer Web

- Next we will log into SQL Developer Web. Start by navigating to the ADW Instance page and clicking on `Service Console`


  ![](./images/1/0311.png  " ")

- Click on `Development`

  ![](./images/1/0023.png  " ")

- Select `SQL Developer Web`

  ![](./images/1/0026.png  " ")

- Log in with `Username` `admin` and `Password` as the password you used when you created the ADW Instance back in Step 2

  ![](./images/1/0025.png  " ")

## **Step 3:** Connection ADW ml_user

- Here we will list the mining model that as created in the notebook

- Signed into SQL Developer Web with the **ml_user credentials**, copy and paste the following:

```
<copy>select * from user_Mining_models;</copy>
N1_CLASS_MODEL    CLASSIFICATION    DECISION_TREE    NATIVE    05-MAR-20        0    NO    

```
- In lab 1, we downloaded the ADW wallet zip file, uploaded it to object
storage, and created an auth_token. Copy the wallet downloaded from Lab 1 to the directory data_pump_dir by entering the following into SQL Developer Web.

```
<copy>BEGIN
     DBMS_CLOUD.GET_OBJECT(
        credential_name => 'api_token',
        object_uri => 'https://objectstorage.us-phoenix-1.oraclecloud.com/n/orasenatdpltintegration02/b/dgcadw/o/cwallet.sso',
        directory_name => 'DATA_PUMP_DIR');
END;
/</copy>
```

- List the files int he data_pump_dir by entering the following:

```
<copy>SELECT * FROM DBMS_CLOUD.LIST_FILES('data_pump_dir');</copy>
cwallet.sso    6733        17-MAR-20 04.36.25.000000000 PM GMT    17-MAR-20 04.36.25.000000000 PM GMT
```

## **Step 4:** Create Connection to ADW admin user

- Log out of SQL Developer Web, and then re-log back in as **admin user** and past the following:

```
<copy>
BEGIN
  DBMS_CLOUD.CREATE_CREDENTIAL(
    credential_name => 'atp_db',
    username => 'ADMIN',
    password => 'WelCome1234#_'
  );
END;
/</copy>
```

- Next, we want to create a database link, the hostname, port, service_name, ssl_server_cert_dn are obtained from the tnsnames.ora file in the ADW wallet. Paste the following into SQL Developer Web:

```
<copy>
begin
dbms_cloud_admin.drop_database_link('atplink');
end;
/

BEGIN
     DBMS_CLOUD_ADMIN.CREATE_DATABASE_LINK(
          db_link_name => 'atplink',
          hostname => 'adb.us-phoenix-1.oraclecloud.com',
          port => '1522',
          service_name => 'qhnwt0ccaorwmt9_orcl2_high.atp.oraclecloud.com',
          ssl_server_cert_dn => 'CN=adwc.uscom-east-1.oraclecloud.com,OU=Oracle BMCS US,O=Oracle Corporation,L=Redwood City,ST=California,C=US',
          credential_name => 'atp_db',
          directory_name => 'DATA_PUMP_DIR');
END;
/

select sysdate from dual@atplink;
/</copy>
17-MAR-20
```

- Log out of admin user and log back in as **ml_user** and past the following into SQL Developer Web:

```
<copy>
create table temp(my_model blob);

DECLARE
 v_blob blob;
BEGIN
 dbms_lob.createtemporary(v_blob, FALSE);
 dbms_data_mining.export_sermodel(v_blob, 'N1_CLASS_MODEL');
 insert into temp values(v_blob);
 commit;
 dbms_lob.freetemporary(v_blob);
END;
/

select length(my_model) from temp;</copy>
85398
```

## **Step 4:** Create Connection to ATP admin user
